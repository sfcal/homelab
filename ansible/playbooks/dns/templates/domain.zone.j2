$ORIGIN {{ domain_name }}.
$TTL 86400      ; 1 day
@       IN SOA  ns.{{ domain_name }}. admin.{{ domain_name }}. (
                                {{ ansible_date_time.year }}{{ ansible_date_time.month }}{{ ansible_date_time.day }}01 ; serial
                                3600       ; refresh (1 hour)
                                3600       ; retry (1 hour)
                                2419200    ; expire (4 weeks)
                                3600       ; minimum (1 hour)
                                )
                        NS      ns.{{ domain_name }}.

; Plex requests should resolve from CF
plex    IN    NS    ns1.cloudflare.com.
plex    IN    NS    ns2.cloudflare.com.

; Name servers (internal)
ns              IN A    10.2.20.53

; Split horizon entries - point to internal IPs
; These override external DNS when resolved internally

; A Records - Services
{% for service in services if (service.dns | default('internal')) != 'external' and service.enabled | default(true) %}
{{ "%-15s"|format(service.name) }} IN A    {{ reverse_proxy_ip if service.proxied else service.backend_host }}
{% endfor %}

